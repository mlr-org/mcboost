<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MCBoostSurv - Basics • mcboost</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MCBoostSurv - Basics">
<meta property="og:description" content="mcboost">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcboost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mcboost_basics_extensions.html">MCBoost - Basics and Extensions</a>
    </li>
    <li>
      <a href="../articles/mcboost_example.html">MCBoost - Health Survey Example</a>
    </li>
    <li>
      <a href="../articles/mcboostsurv_basics.html">MCBoostSurv - Basics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mcboost/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mcboostsurv_basics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MCBoostSurv - Basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mcboost/blob/HEAD/vignettes/mcboostsurv_basics.Rmd" class="external-link"><code>vignettes/mcboostsurv_basics.Rmd</code></a></small>
      <div class="hidden name"><code>mcboostsurv_basics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mlr-org/mcboost" class="external-link">"mcboost"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3.mlr-org.com" class="external-link">"mlr3"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3proba.mlr-org.com" class="external-link">"mlr3proba"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3pipelines.mlr-org.com" class="external-link">"mlr3pipelines"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com" class="external-link">"mlr3learners"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.7</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27099</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="minimal-example-mcboostsurv">Minimal Example: McBoostSurv<a class="anchor" aria-label="anchor" href="#minimal-example-mcboostsurv"></a>
</h2>
<p>To show the basic functionality of <code>MCBoostSurv</code>, we provide a minimal example on the standard survival data set rats. After loading and pre-processing the data, we train a <code>mlr3learner</code> on the training data. We instantiate a <code>MCBoostSurv</code> instance with the default parameters. Then, we run the <code>$multicalibrate()</code> method on our data to start multi-calibration in survival analysis. With <code>$predict_probs()</code>, we can get multicalibrated predictions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#prepare task </span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tsk</a></span><span class="op">(</span><span class="st">"rats"</span><span class="op">)</span>
<span class="va">prep_pipe</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com//reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"encode"</span>, param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"one-hot"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">prep</span> <span class="op">=</span> <span class="va">prep_pipe</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="co">#split data</span>
<span class="va">train</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">199</span><span class="op">)</span>
<span class="va">val</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">200</span><span class="op">:</span><span class="fl">250</span><span class="op">)</span>
<span class="va">test</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">256</span><span class="op">:</span><span class="fl">300</span><span class="op">)</span>

<span class="co"># get trained survival model </span>
<span class="va">baseline</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"surv.ranger"</span><span class="op">)</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">train</span><span class="op">)</span>

<span class="co"># initialize mcboost</span>
<span class="va">mc_surv</span> <span class="op">=</span> <span class="va"><a href="../reference/MCBoostSurv.html">MCBoostSurv</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>init_predictor <span class="op">=</span> <span class="va">baseline</span><span class="op">)</span>

<span class="co"># multicalibrate model </span>
<span class="va">mc_surv</span><span class="op">$</span><span class="fu">multicalibrate</span><span class="op">(</span>data <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">feature_names</span><span class="op">)</span>, 
                       labels <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">target_names</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get new predictions</span>
<span class="va">mc_surv</span><span class="op">$</span><span class="fu">predict_probs</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">feature_names</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     0        23        32        34        39        40        45        49</span>
<span class="co">#&gt;  1: 1 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780</span>
<span class="co">#&gt;  2: 1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  3: 1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  4: 1 0.8713450 0.8713450 0.8321996 0.8272552 0.8260297 0.8260297 0.8250502</span>
<span class="co">#&gt;  5: 1 0.9504823 0.9504823 0.9437723 0.9424955 0.9372363 0.9372363 0.9348718</span>
<span class="co">#&gt;  6: 1 0.9504823 0.9504823 0.9437723 0.9424955 0.9372363 0.9372363 0.9348718</span>
<span class="co">#&gt;  7: 1 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727</span>
<span class="co">#&gt;  8: 1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  9: 1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt; 10: 1 0.8579876 0.8579876 0.8194423 0.8145737 0.8133670 0.8133670 0.8124025</span>
<span class="co">#&gt; 11: 1 0.9359118 0.9359118 0.9293047 0.9280474 0.9228688 0.9228688 0.9205405</span>
<span class="co">#&gt; 12: 1 0.9359118 0.9359118 0.9293047 0.9280474 0.9228688 0.9228688 0.9205405</span>
<span class="co">#&gt; 13: 1 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867</span>
<span class="co">#&gt; 14: 1 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 15: 1 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 16: 1 0.8448350 0.8448350 0.8068806 0.8020866 0.8008984 0.8008984 0.7999487</span>
<span class="co">#&gt; 17: 1 0.9215647 0.9215647 0.9150588 0.9138208 0.9087216 0.9087216 0.9064290</span>
<span class="co">#&gt; 18: 1 0.9215647 0.9215647 0.9150588 0.9138208 0.9087216 0.9087216 0.9064290</span>
<span class="co">#&gt; 19: 1 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167</span>
<span class="co">#&gt; 20: 1 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 21: 1 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 22: 1 0.8318840 0.8318840 0.7945114 0.7897909 0.7886209 0.7886209 0.7876858</span>
<span class="co">#&gt; 23: 1 0.9074374 0.9074374 0.9010313 0.8998123 0.8947912 0.8947912 0.8925338</span>
<span class="co">#&gt; 24: 1 0.9074374 0.9074374 0.9010313 0.8998123 0.8947912 0.8947912 0.8925338</span>
<span class="co">#&gt; 25: 1 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593</span>
<span class="co">#&gt; 26: 1 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 27: 1 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 28: 1 0.8191316 0.8191316 0.7823319 0.7776837 0.7765316 0.7765316 0.7756109</span>
<span class="co">#&gt; 29: 1 0.8935268 0.8935268 0.8872188 0.8860185 0.8810744 0.8810744 0.8788516</span>
<span class="co">#&gt; 30: 1 0.8935268 0.8935268 0.8872188 0.8860185 0.8810744 0.8810744 0.8788516</span>
<span class="co">#&gt; 31: 1 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113</span>
<span class="co">#&gt; 32: 1 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 33: 1 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 34: 1 0.8065746 0.8065746 0.7703390 0.7657621 0.7646277 0.7646277 0.7637211</span>
<span class="co">#&gt; 35: 1 0.8798293 0.8798293 0.8736181 0.8724362 0.8675679 0.8675679 0.8653792</span>
<span class="co">#&gt; 36: 1 0.8798293 0.8798293 0.8736181 0.8724362 0.8675679 0.8675679 0.8653792</span>
<span class="co">#&gt; 37: 1 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694</span>
<span class="co">#&gt; 38: 1 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 39: 1 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 40: 1 0.7942101 0.7942101 0.7585300 0.7540233 0.7529063 0.7529063 0.7520135</span>
<span class="co">#&gt; 41: 1 0.8663419 0.8663419 0.8602259 0.8590621 0.8542684 0.8542684 0.8521132</span>
<span class="co">#&gt; 42: 1 0.8663419 0.8663419 0.8602259 0.8590621 0.8542684 0.8542684 0.8521132</span>
<span class="co">#&gt; 43: 1 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305</span>
<span class="co">#&gt; 44: 1 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt; 45: 1 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt;     0        23        32        34        39        40        45        49</span>
<span class="co">#&gt;            50        51        53        54        55        61        62</span>
<span class="co">#&gt;  1: 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780</span>
<span class="co">#&gt;  2: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  3: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  4: 0.8237375 0.8237375 0.8237375 0.8177915 0.8135041 0.8135041 0.8135041</span>
<span class="co">#&gt;  5: 0.9316563 0.9316563 0.9316563 0.9041789 0.8841394 0.8841394 0.8841394</span>
<span class="co">#&gt;  6: 0.9316563 0.9316563 0.9316563 0.9041789 0.8841394 0.8841394 0.8841394</span>
<span class="co">#&gt;  7: 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727</span>
<span class="co">#&gt;  8: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  9: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt; 10: 0.8111099 0.8111099 0.8111099 0.8052551 0.8010334 0.8010334 0.8010334</span>
<span class="co">#&gt; 11: 0.9173744 0.9173744 0.9173744 0.8903182 0.8705859 0.8705859 0.8705859</span>
<span class="co">#&gt; 12: 0.9173744 0.9173744 0.9173744 0.8903182 0.8705859 0.8705859 0.8705859</span>
<span class="co">#&gt; 13: 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867</span>
<span class="co">#&gt; 14: 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 15: 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 16: 0.7986759 0.7986759 0.7986759 0.7929108 0.7887538 0.7887538 0.7887538</span>
<span class="co">#&gt; 17: 0.9033114 0.9033114 0.9033114 0.8766700 0.8572401 0.8572401 0.8572401</span>
<span class="co">#&gt; 18: 0.9033114 0.9033114 0.9033114 0.8766700 0.8572401 0.8572401 0.8572401</span>
<span class="co">#&gt; 19: 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167</span>
<span class="co">#&gt; 20: 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 21: 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 22: 0.7864325 0.7864325 0.7864325 0.7807558 0.7766626 0.7766626 0.7766626</span>
<span class="co">#&gt; 23: 0.8894640 0.8894640 0.8894640 0.8632310 0.8440990 0.8440990 0.8440990</span>
<span class="co">#&gt; 24: 0.8894640 0.8894640 0.8894640 0.8632310 0.8440990 0.8440990 0.8440990</span>
<span class="co">#&gt; 25: 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593</span>
<span class="co">#&gt; 26: 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 27: 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 28: 0.7743768 0.7743768 0.7743768 0.7687871 0.7647566 0.7647566 0.7647566</span>
<span class="co">#&gt; 29: 0.8758288 0.8758288 0.8758288 0.8499980 0.8311593 0.8311593 0.8311593</span>
<span class="co">#&gt; 30: 0.8758288 0.8758288 0.8758288 0.8499980 0.8311593 0.8311593 0.8311593</span>
<span class="co">#&gt; 31: 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113</span>
<span class="co">#&gt; 32: 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 33: 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 34: 0.7625059 0.7625059 0.7625059 0.7570019 0.7530332 0.7530332 0.7530332</span>
<span class="co">#&gt; 35: 0.8624027 0.8624027 0.8624027 0.8369678 0.8184179 0.8184179 0.8184179</span>
<span class="co">#&gt; 36: 0.8624027 0.8624027 0.8624027 0.8369678 0.8184179 0.8184179 0.8184179</span>
<span class="co">#&gt; 37: 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694</span>
<span class="co">#&gt; 38: 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 39: 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 40: 0.7508170 0.7508170 0.7508170 0.7453973 0.7414895 0.7414895 0.7414895</span>
<span class="co">#&gt; 41: 0.8491824 0.8491824 0.8491824 0.8241374 0.8058719 0.8058719 0.8058719</span>
<span class="co">#&gt; 42: 0.8491824 0.8491824 0.8491824 0.8241374 0.8058719 0.8058719 0.8058719</span>
<span class="co">#&gt; 43: 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305</span>
<span class="co">#&gt; 44: 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt; 45: 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt;            50        51        53        54        55        61        62</span>
<span class="co">#&gt;            63        64        65        67        68        69        70</span>
<span class="co">#&gt;  1: 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780 0.9331780</span>
<span class="co">#&gt;  2: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  3: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  4: 0.8135041 0.8079021 0.8079021 0.8025121 0.8012787 0.8012787 0.7959998</span>
<span class="co">#&gt;  5: 0.8841394 0.8614697 0.8614697 0.8604352 0.8557972 0.8557972 0.8547107</span>
<span class="co">#&gt;  6: 0.8841394 0.8614697 0.8614697 0.8604352 0.8557972 0.8557972 0.8547107</span>
<span class="co">#&gt;  7: 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727 0.9188727</span>
<span class="co">#&gt;  8: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  9: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt; 10: 0.8010334 0.7955172 0.7955172 0.7902099 0.7889954 0.7889954 0.7837974</span>
<span class="co">#&gt; 11: 0.8705859 0.8482637 0.8482637 0.8472450 0.8426782 0.8426782 0.8416083</span>
<span class="co">#&gt; 12: 0.8705859 0.8482637 0.8482637 0.8472450 0.8426782 0.8426782 0.8416083</span>
<span class="co">#&gt; 13: 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867 0.9047867</span>
<span class="co">#&gt; 14: 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 15: 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613 0.9869613</span>
<span class="co">#&gt; 16: 0.7887538 0.7833223 0.7833223 0.7780963 0.7769004 0.7769004 0.7717821</span>
<span class="co">#&gt; 17: 0.8572401 0.8352601 0.8352601 0.8342571 0.8297603 0.8297603 0.8287068</span>
<span class="co">#&gt; 18: 0.8572401 0.8352601 0.8352601 0.8342571 0.8297603 0.8297603 0.8287068</span>
<span class="co">#&gt; 19: 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167 0.8909167</span>
<span class="co">#&gt; 20: 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 21: 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316 0.9718316</span>
<span class="co">#&gt; 22: 0.7766626 0.7713142 0.7713142 0.7661684 0.7649908 0.7649908 0.7599510</span>
<span class="co">#&gt; 23: 0.8440990 0.8224559 0.8224559 0.8214683 0.8170404 0.8170404 0.8160030</span>
<span class="co">#&gt; 24: 0.8440990 0.8224559 0.8224559 0.8214683 0.8170404 0.8170404 0.8160030</span>
<span class="co">#&gt; 25: 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593 0.8772593</span>
<span class="co">#&gt; 26: 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 27: 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338 0.9569338</span>
<span class="co">#&gt; 28: 0.7647566 0.7594903 0.7594903 0.7544234 0.7532638 0.7532638 0.7483012</span>
<span class="co">#&gt; 29: 0.8311593 0.8098480 0.8098480 0.8088755 0.8045155 0.8045155 0.8034940</span>
<span class="co">#&gt; 30: 0.8311593 0.8098480 0.8098480 0.8088755 0.8045155 0.8045155 0.8034940</span>
<span class="co">#&gt; 31: 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113 0.8638113</span>
<span class="co">#&gt; 32: 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 33: 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643 0.9422643</span>
<span class="co">#&gt; 34: 0.7530332 0.7478476 0.7478476 0.7428583 0.7417165 0.7417165 0.7368301</span>
<span class="co">#&gt; 35: 0.8184179 0.7974333 0.7974333 0.7964757 0.7921825 0.7921825 0.7911767</span>
<span class="co">#&gt; 36: 0.8184179 0.7974333 0.7974333 0.7964757 0.7921825 0.7921825 0.7911767</span>
<span class="co">#&gt; 37: 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694 0.8505694</span>
<span class="co">#&gt; 38: 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 39: 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198 0.9278198</span>
<span class="co">#&gt; 40: 0.7414895 0.7363834 0.7363834 0.7314706 0.7303463 0.7303463 0.7255347</span>
<span class="co">#&gt; 41: 0.8058719 0.7852090 0.7852090 0.7842660 0.7800387 0.7800387 0.7790483</span>
<span class="co">#&gt; 42: 0.8058719 0.7852090 0.7852090 0.7842660 0.7800387 0.7800387 0.7790483</span>
<span class="co">#&gt; 43: 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305 0.8375305</span>
<span class="co">#&gt; 44: 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt; 45: 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967 0.9135967</span>
<span class="co">#&gt;            63        64        65        67        68        69        70</span>
<span class="co">#&gt;            71        72        73        74        75        76        77</span>
<span class="co">#&gt;  1: 0.8681876 0.8681876 0.8678404 0.8678404 0.8678404 0.8678404 0.8678404</span>
<span class="co">#&gt;  2: 0.8973539 0.8973539 0.8943379 0.8943379 0.8943379 0.8943379 0.8943379</span>
<span class="co">#&gt;  3: 0.8973539 0.8973539 0.8943379 0.8943379 0.8943379 0.8943379 0.8943379</span>
<span class="co">#&gt;  4: 0.7943816 0.7943816 0.7735150 0.7735150 0.7735150 0.7735150 0.7723524</span>
<span class="co">#&gt;  5: 0.8482907 0.8482907 0.7860867 0.7860867 0.7860867 0.7860867 0.7827692</span>
<span class="co">#&gt;  6: 0.8482907 0.8482907 0.7860867 0.7860867 0.7860867 0.7860867 0.7827692</span>
<span class="co">#&gt;  7: 0.8548786 0.8548786 0.8545367 0.8545367 0.8545367 0.8545367 0.8545367</span>
<span class="co">#&gt;  8: 0.8835978 0.8835978 0.8806280 0.8806280 0.8806280 0.8806280 0.8806280</span>
<span class="co">#&gt;  9: 0.8835978 0.8835978 0.8806280 0.8806280 0.8806280 0.8806280 0.8806280</span>
<span class="co">#&gt; 10: 0.7822041 0.7822041 0.7616573 0.7616573 0.7616573 0.7616573 0.7605126</span>
<span class="co">#&gt; 11: 0.8352867 0.8352867 0.7740363 0.7740363 0.7740363 0.7740363 0.7707697</span>
<span class="co">#&gt; 12: 0.8352867 0.8352867 0.7740363 0.7740363 0.7740363 0.7740363 0.7707697</span>
<span class="co">#&gt; 13: 0.8417737 0.8417737 0.8414370 0.8414370 0.8414370 0.8414370 0.8414370</span>
<span class="co">#&gt; 14: 0.8700526 0.8700526 0.8671284 0.8671284 0.8671284 0.8671284 0.8671284</span>
<span class="co">#&gt; 15: 0.8700526 0.8700526 0.8671284 0.8671284 0.8671284 0.8671284 0.8671284</span>
<span class="co">#&gt; 16: 0.7702132 0.7702132 0.7499814 0.7499814 0.7499814 0.7499814 0.7488542</span>
<span class="co">#&gt; 17: 0.8224821 0.8224821 0.7621706 0.7621706 0.7621706 0.7621706 0.7589541</span>
<span class="co">#&gt; 18: 0.8224821 0.8224821 0.7621706 0.7621706 0.7621706 0.7621706 0.7589541</span>
<span class="co">#&gt; 19: 0.8288696 0.8288696 0.8285381 0.8285381 0.8285381 0.8285381 0.8285381</span>
<span class="co">#&gt; 20: 0.8567150 0.8567150 0.8538356 0.8538356 0.8538356 0.8538356 0.8538356</span>
<span class="co">#&gt; 21: 0.8567150 0.8567150 0.8538356 0.8538356 0.8538356 0.8538356 0.8538356</span>
<span class="co">#&gt; 22: 0.7584061 0.7584061 0.7384844 0.7384844 0.7384844 0.7384844 0.7373746</span>
<span class="co">#&gt; 23: 0.8098737 0.8098737 0.7504869 0.7504869 0.7504869 0.7504869 0.7473196</span>
<span class="co">#&gt; 24: 0.8098737 0.8098737 0.7504869 0.7504869 0.7504869 0.7504869 0.7473196</span>
<span class="co">#&gt; 25: 0.8161634 0.8161634 0.8158370 0.8158370 0.8158370 0.8158370 0.8158370</span>
<span class="co">#&gt; 26: 0.8435819 0.8435819 0.8407466 0.8407466 0.8407466 0.8407466 0.8407466</span>
<span class="co">#&gt; 27: 0.8435819 0.8435819 0.8407466 0.8407466 0.8407466 0.8407466 0.8407466</span>
<span class="co">#&gt; 28: 0.7467800 0.7467800 0.7271638 0.7271638 0.7271638 0.7271638 0.7260709</span>
<span class="co">#&gt; 29: 0.7974587 0.7974587 0.7389822 0.7389822 0.7389822 0.7389822 0.7358635</span>
<span class="co">#&gt; 30: 0.7974587 0.7974587 0.7389822 0.7389822 0.7389822 0.7389822 0.7358635</span>
<span class="co">#&gt; 31: 0.8036519 0.8036519 0.8033305 0.8033305 0.8033305 0.8033305 0.8033305</span>
<span class="co">#&gt; 32: 0.8306501 0.8306501 0.8278583 0.8278583 0.8278583 0.8278583 0.8278583</span>
<span class="co">#&gt; 33: 0.8306501 0.8306501 0.8278583 0.8278583 0.8278583 0.8278583 0.8278583</span>
<span class="co">#&gt; 34: 0.7353322 0.7353322 0.7160166 0.7160166 0.7160166 0.7160166 0.7149405</span>
<span class="co">#&gt; 35: 0.7852339 0.7852339 0.7276539 0.7276539 0.7276539 0.7276539 0.7245830</span>
<span class="co">#&gt; 36: 0.7852339 0.7852339 0.7276539 0.7276539 0.7276539 0.7276539 0.7245830</span>
<span class="co">#&gt; 37: 0.7913322 0.7913322 0.7910157 0.7910157 0.7910157 0.7910157 0.7910157</span>
<span class="co">#&gt; 38: 0.8179166 0.8179166 0.8151676 0.8151676 0.8151676 0.8151676 0.8151676</span>
<span class="co">#&gt; 39: 0.8179166 0.8179166 0.8151676 0.8151676 0.8151676 0.8151676 0.8151676</span>
<span class="co">#&gt; 40: 0.7240598 0.7240598 0.7050404 0.7050404 0.7050404 0.7050404 0.7039808</span>
<span class="co">#&gt; 41: 0.7731966 0.7731966 0.7164992 0.7164992 0.7164992 0.7164992 0.7134754</span>
<span class="co">#&gt; 42: 0.7731966 0.7731966 0.7164992 0.7164992 0.7164992 0.7164992 0.7134754</span>
<span class="co">#&gt; 43: 0.7792014 0.7792014 0.7788898 0.7788898 0.7788898 0.7788898 0.7788898</span>
<span class="co">#&gt; 44: 0.8053783 0.8053783 0.8026714 0.8026714 0.8026714 0.8026714 0.8026714</span>
<span class="co">#&gt; 45: 0.8053783 0.8053783 0.8026714 0.8026714 0.8026714 0.8026714 0.8026714</span>
<span class="co">#&gt;            71        72        73        74        75        76        77</span>
<span class="co">#&gt;            78        79        80        81        82        83        84</span>
<span class="co">#&gt;  1: 0.8678404 0.8678404 0.8306138 0.8306138 0.8306138 0.8306138 0.8295347</span>
<span class="co">#&gt;  2: 0.8943379 0.8943379 0.8636886 0.8636886 0.8636886 0.8636886 0.8587795</span>
<span class="co">#&gt;  3: 0.8943379 0.8943379 0.8636886 0.8636886 0.8636886 0.8636886 0.8587795</span>
<span class="co">#&gt;  4: 0.7723524 0.7723524 0.6296026 0.6234486 0.6234486 0.6234486 0.5924918</span>
<span class="co">#&gt;  5: 0.7827692 0.7827692 0.7179038 0.6915831 0.6915831 0.6915831 0.5918005</span>
<span class="co">#&gt;  6: 0.7827692 0.7827692 0.7179038 0.6915831 0.6915831 0.6915831 0.5918005</span>
<span class="co">#&gt;  7: 0.8545367 0.8545367 0.8178808 0.8178808 0.8178808 0.8178808 0.8168183</span>
<span class="co">#&gt;  8: 0.8806280 0.8806280 0.8504485 0.8504485 0.8504485 0.8504485 0.8456148</span>
<span class="co">#&gt;  9: 0.8806280 0.8806280 0.8504485 0.8504485 0.8504485 0.8504485 0.8456148</span>
<span class="co">#&gt; 10: 0.7605126 0.7605126 0.6199510 0.6138913 0.6138913 0.6138913 0.5834091</span>
<span class="co">#&gt; 11: 0.7707697 0.7707697 0.7068987 0.6809814 0.6809814 0.6809814 0.5827285</span>
<span class="co">#&gt; 12: 0.7707697 0.7707697 0.7068987 0.6809814 0.6809814 0.6809814 0.5827285</span>
<span class="co">#&gt; 13: 0.8414370 0.8414370 0.8053430 0.8053430 0.8053430 0.8053430 0.8042968</span>
<span class="co">#&gt; 14: 0.8671284 0.8671284 0.8374115 0.8374115 0.8374115 0.8374115 0.8326518</span>
<span class="co">#&gt; 15: 0.8671284 0.8671284 0.8374115 0.8374115 0.8374115 0.8374115 0.8326518</span>
<span class="co">#&gt; 16: 0.7488542 0.7488542 0.6104474 0.6044806 0.6044806 0.6044806 0.5744657</span>
<span class="co">#&gt; 17: 0.7589541 0.7589541 0.6960622 0.6705422 0.6705422 0.6705422 0.5737955</span>
<span class="co">#&gt; 18: 0.7589541 0.7589541 0.6960622 0.6705422 0.6705422 0.6705422 0.5737955</span>
<span class="co">#&gt; 19: 0.8285381 0.8285381 0.7929974 0.7929974 0.7929974 0.7929974 0.7919672</span>
<span class="co">#&gt; 20: 0.8538356 0.8538356 0.8245743 0.8245743 0.8245743 0.8245743 0.8198876</span>
<span class="co">#&gt; 21: 0.8538356 0.8538356 0.8245743 0.8245743 0.8245743 0.8245743 0.8198876</span>
<span class="co">#&gt; 22: 0.7373746 0.7373746 0.6010895 0.5952142 0.5952142 0.5952142 0.5656594</span>
<span class="co">#&gt; 23: 0.7473196 0.7473196 0.6853918 0.6602630 0.6602630 0.6602630 0.5649994</span>
<span class="co">#&gt; 24: 0.7473196 0.7473196 0.6853918 0.6602630 0.6602630 0.6602630 0.5649994</span>
<span class="co">#&gt; 25: 0.8158370 0.8158370 0.7808411 0.7808411 0.7808411 0.7808411 0.7798267</span>
<span class="co">#&gt; 26: 0.8407466 0.8407466 0.8119339 0.8119339 0.8119339 0.8119339 0.8073190</span>
<span class="co">#&gt; 27: 0.8407466 0.8407466 0.8119339 0.8119339 0.8119339 0.8119339 0.8073190</span>
<span class="co">#&gt; 28: 0.7260709 0.7260709 0.5918750 0.5860898 0.5860898 0.5860898 0.5569880</span>
<span class="co">#&gt; 29: 0.7358635 0.7358635 0.6748850 0.6501415 0.6501415 0.6501415 0.5563382</span>
<span class="co">#&gt; 30: 0.7358635 0.7358635 0.6748850 0.6501415 0.6501415 0.6501415 0.5563382</span>
<span class="co">#&gt; 31: 0.8033305 0.8033305 0.7688711 0.7688711 0.7688711 0.7688711 0.7678722</span>
<span class="co">#&gt; 32: 0.8278583 0.8278583 0.7994873 0.7994873 0.7994873 0.7994873 0.7949432</span>
<span class="co">#&gt; 33: 0.8278583 0.8278583 0.7994873 0.7994873 0.7994873 0.7994873 0.7949432</span>
<span class="co">#&gt; 34: 0.7149405 0.7149405 0.5828018 0.5771052 0.5771052 0.5771052 0.5484496</span>
<span class="co">#&gt; 35: 0.7245830 0.7245830 0.6645393 0.6401750 0.6401750 0.6401750 0.5478097</span>
<span class="co">#&gt; 36: 0.7245830 0.7245830 0.6645393 0.6401750 0.6401750 0.6401750 0.5478097</span>
<span class="co">#&gt; 37: 0.7910157 0.7910157 0.7570846 0.7570846 0.7570846 0.7570846 0.7561010</span>
<span class="co">#&gt; 38: 0.8151676 0.8151676 0.7872314 0.7872314 0.7872314 0.7872314 0.7827570</span>
<span class="co">#&gt; 39: 0.8151676 0.8151676 0.7872314 0.7872314 0.7872314 0.7872314 0.7827570</span>
<span class="co">#&gt; 40: 0.7039808 0.7039808 0.5738677 0.5682584 0.5682584 0.5682584 0.5400421</span>
<span class="co">#&gt; 41: 0.7134754 0.7134754 0.6543522 0.6303614 0.6303614 0.6303614 0.5394120</span>
<span class="co">#&gt; 42: 0.7134754 0.7134754 0.6543522 0.6303614 0.6303614 0.6303614 0.5394120</span>
<span class="co">#&gt; 43: 0.7788898 0.7788898 0.7454788 0.7454788 0.7454788 0.7454788 0.7445103</span>
<span class="co">#&gt; 44: 0.8026714 0.8026714 0.7751635 0.7751635 0.7751635 0.7751635 0.7707576</span>
<span class="co">#&gt; 45: 0.8026714 0.8026714 0.7751635 0.7751635 0.7751635 0.7751635 0.7707576</span>
<span class="co">#&gt;            78        79        80        81        82        83        84</span>
<span class="co">#&gt;            85        86        87        88        89        90        91</span>
<span class="co">#&gt;  1: 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347</span>
<span class="co">#&gt;  2: 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795</span>
<span class="co">#&gt;  3: 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795</span>
<span class="co">#&gt;  4: 0.5924918 0.5500625 0.5500625 0.5456006 0.5406167 0.5406167 0.5406167</span>
<span class="co">#&gt;  5: 0.5918005 0.5864523 0.5864523 0.5854622 0.5843837 0.5843837 0.5843837</span>
<span class="co">#&gt;  6: 0.5918005 0.5864523 0.5864523 0.5854622 0.5843837 0.5843837 0.5843837</span>
<span class="co">#&gt;  7: 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183</span>
<span class="co">#&gt;  8: 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148</span>
<span class="co">#&gt;  9: 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148</span>
<span class="co">#&gt; 10: 0.5834091 0.5416303 0.5416303 0.5372367 0.5323293 0.5323293 0.5323293</span>
<span class="co">#&gt; 11: 0.5827285 0.5774622 0.5774622 0.5764873 0.5754253 0.5754253 0.5754253</span>
<span class="co">#&gt; 12: 0.5827285 0.5774622 0.5774622 0.5764873 0.5754253 0.5754253 0.5754253</span>
<span class="co">#&gt; 13: 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968</span>
<span class="co">#&gt; 14: 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518</span>
<span class="co">#&gt; 15: 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518</span>
<span class="co">#&gt; 16: 0.5744657 0.5333273 0.5333273 0.5290011 0.5241689 0.5241689 0.5241689</span>
<span class="co">#&gt; 17: 0.5737955 0.5686099 0.5686099 0.5676500 0.5666042 0.5666042 0.5666042</span>
<span class="co">#&gt; 18: 0.5737955 0.5686099 0.5686099 0.5676500 0.5666042 0.5666042 0.5666042</span>
<span class="co">#&gt; 19: 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672</span>
<span class="co">#&gt; 20: 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876</span>
<span class="co">#&gt; 21: 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876</span>
<span class="co">#&gt; 22: 0.5656594 0.5251516 0.5251516 0.5208917 0.5161336 0.5161336 0.5161336</span>
<span class="co">#&gt; 23: 0.5649994 0.5598934 0.5598934 0.5589481 0.5579184 0.5579184 0.5579184</span>
<span class="co">#&gt; 24: 0.5649994 0.5598934 0.5598934 0.5589481 0.5579184 0.5579184 0.5579184</span>
<span class="co">#&gt; 25: 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267</span>
<span class="co">#&gt; 26: 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190</span>
<span class="co">#&gt; 27: 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190</span>
<span class="co">#&gt; 28: 0.5569880 0.5171012 0.5171012 0.5129067 0.5082215 0.5082215 0.5082215</span>
<span class="co">#&gt; 29: 0.5563382 0.5513104 0.5513104 0.5503797 0.5493657 0.5493657 0.5493657</span>
<span class="co">#&gt; 30: 0.5563382 0.5513104 0.5513104 0.5503797 0.5493657 0.5493657 0.5493657</span>
<span class="co">#&gt; 31: 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722</span>
<span class="co">#&gt; 32: 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432</span>
<span class="co">#&gt; 33: 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432</span>
<span class="co">#&gt; 34: 0.5484496 0.5091743 0.5091743 0.5050440 0.5004306 0.5004306 0.5004306</span>
<span class="co">#&gt; 35: 0.5478097 0.5428590 0.5428590 0.5419426 0.5409442 0.5409442 0.5409442</span>
<span class="co">#&gt; 36: 0.5478097 0.5428590 0.5428590 0.5419426 0.5409442 0.5409442 0.5409442</span>
<span class="co">#&gt; 37: 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010</span>
<span class="co">#&gt; 38: 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570</span>
<span class="co">#&gt; 39: 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570</span>
<span class="co">#&gt; 40: 0.5400421 0.5013688 0.5013688 0.4973019 0.4927592 0.4927592 0.4927592</span>
<span class="co">#&gt; 41: 0.5394120 0.5345372 0.5345372 0.5336348 0.5326517 0.5326517 0.5326517</span>
<span class="co">#&gt; 42: 0.5394120 0.5345372 0.5345372 0.5336348 0.5326517 0.5326517 0.5326517</span>
<span class="co">#&gt; 43: 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103</span>
<span class="co">#&gt; 44: 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576</span>
<span class="co">#&gt; 45: 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576</span>
<span class="co">#&gt;            85        86        87        88        89        90        91</span>
<span class="co">#&gt;            92        93        94        95        96        97        98</span>
<span class="co">#&gt;  1: 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347 0.8295347</span>
<span class="co">#&gt;  2: 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795</span>
<span class="co">#&gt;  3: 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795 0.8587795</span>
<span class="co">#&gt;  4: 0.5406167 0.5406167 0.5406167 0.5406167 0.5327361 0.5327361 0.5327361</span>
<span class="co">#&gt;  5: 0.5843837 0.5843837 0.5843837 0.5843837 0.5789984 0.5789984 0.5789984</span>
<span class="co">#&gt;  6: 0.5843837 0.5843837 0.5843837 0.5843837 0.5789984 0.5789984 0.5789984</span>
<span class="co">#&gt;  7: 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183 0.8168183</span>
<span class="co">#&gt;  8: 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148</span>
<span class="co">#&gt;  9: 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148 0.8456148</span>
<span class="co">#&gt; 10: 0.5323293 0.5323293 0.5323293 0.5323293 0.5245694 0.5245694 0.5245694</span>
<span class="co">#&gt; 11: 0.5754253 0.5754253 0.5754253 0.5754253 0.5701225 0.5701225 0.5701225</span>
<span class="co">#&gt; 12: 0.5754253 0.5754253 0.5754253 0.5754253 0.5701225 0.5701225 0.5701225</span>
<span class="co">#&gt; 13: 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968 0.8042968</span>
<span class="co">#&gt; 14: 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518</span>
<span class="co">#&gt; 15: 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518 0.8326518</span>
<span class="co">#&gt; 16: 0.5241689 0.5241689 0.5241689 0.5241689 0.5165280 0.5165280 0.5165280</span>
<span class="co">#&gt; 17: 0.5666042 0.5666042 0.5666042 0.5666042 0.5613828 0.5613828 0.5613828</span>
<span class="co">#&gt; 18: 0.5666042 0.5666042 0.5666042 0.5666042 0.5613828 0.5613828 0.5613828</span>
<span class="co">#&gt; 19: 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672 0.7919672</span>
<span class="co">#&gt; 20: 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876</span>
<span class="co">#&gt; 21: 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876 0.8198876</span>
<span class="co">#&gt; 22: 0.5161336 0.5161336 0.5161336 0.5161336 0.5086098 0.5086098 0.5086098</span>
<span class="co">#&gt; 23: 0.5579184 0.5579184 0.5579184 0.5579184 0.5527770 0.5527770 0.5527770</span>
<span class="co">#&gt; 24: 0.5579184 0.5579184 0.5579184 0.5579184 0.5527770 0.5527770 0.5527770</span>
<span class="co">#&gt; 25: 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267 0.7798267</span>
<span class="co">#&gt; 26: 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190</span>
<span class="co">#&gt; 27: 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190 0.8073190</span>
<span class="co">#&gt; 28: 0.5082215 0.5082215 0.5082215 0.5082215 0.5008130 0.5008130 0.5008130</span>
<span class="co">#&gt; 29: 0.5493657 0.5493657 0.5493657 0.5493657 0.5443031 0.5443031 0.5443031</span>
<span class="co">#&gt; 30: 0.5493657 0.5493657 0.5493657 0.5493657 0.5443031 0.5443031 0.5443031</span>
<span class="co">#&gt; 31: 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722 0.7678722</span>
<span class="co">#&gt; 32: 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432</span>
<span class="co">#&gt; 33: 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432 0.7949432</span>
<span class="co">#&gt; 34: 0.5004306 0.5004306 0.5004306 0.5004306 0.4931358 0.4931358 0.4931358</span>
<span class="co">#&gt; 35: 0.5409442 0.5409442 0.5409442 0.5409442 0.5359592 0.5359592 0.5359592</span>
<span class="co">#&gt; 36: 0.5409442 0.5409442 0.5409442 0.5409442 0.5359592 0.5359592 0.5359592</span>
<span class="co">#&gt; 37: 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010 0.7561010</span>
<span class="co">#&gt; 38: 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570</span>
<span class="co">#&gt; 39: 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570 0.7827570</span>
<span class="co">#&gt; 40: 0.4927592 0.4927592 0.4927592 0.4927592 0.4855762 0.4855762 0.4855762</span>
<span class="co">#&gt; 41: 0.5326517 0.5326517 0.5326517 0.5326517 0.5277431 0.5277431 0.5277431</span>
<span class="co">#&gt; 42: 0.5326517 0.5326517 0.5326517 0.5326517 0.5277431 0.5277431 0.5277431</span>
<span class="co">#&gt; 43: 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103 0.7445103</span>
<span class="co">#&gt; 44: 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576</span>
<span class="co">#&gt; 45: 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576 0.7707576</span>
<span class="co">#&gt;            92        93        94        95        96        97        98</span>
<span class="co">#&gt;            99       100       101       102       103       104 104.001</span>
<span class="co">#&gt;  1: 0.8295347 0.8295347 0.8295347 0.8171067 0.8033333 0.8033333       0</span>
<span class="co">#&gt;  2: 0.8587795 0.8587795 0.8587795 0.8557994 0.8557994 0.8557994       0</span>
<span class="co">#&gt;  3: 0.8587795 0.8587795 0.8587795 0.8557994 0.8557994 0.8557994       0</span>
<span class="co">#&gt;  4: 0.5327361 0.5327361 0.5327361 0.3959103 0.2901667 0.2847652       0</span>
<span class="co">#&gt;  5: 0.5789984 0.5789984 0.5789984 0.5220405 0.4842681 0.4828091       0</span>
<span class="co">#&gt;  6: 0.5789984 0.5789984 0.5789984 0.5220405 0.4842681 0.4828091       0</span>
<span class="co">#&gt;  7: 0.8168183 0.8168183 0.8168183 0.8045808 0.7910185 0.7910185       0</span>
<span class="co">#&gt;  8: 0.8456148 0.8456148 0.8456148 0.8426804 0.8426804 0.8426804       0</span>
<span class="co">#&gt;  9: 0.8456148 0.8456148 0.8456148 0.8426804 0.8426804 0.8426804       0</span>
<span class="co">#&gt; 10: 0.5245694 0.5245694 0.5245694 0.3898411 0.2857185 0.2803999       0</span>
<span class="co">#&gt; 11: 0.5701225 0.5701225 0.5701225 0.5140378 0.4768445 0.4754078       0</span>
<span class="co">#&gt; 12: 0.5701225 0.5701225 0.5701225 0.5140378 0.4768445 0.4754078       0</span>
<span class="co">#&gt; 13: 0.8042968 0.8042968 0.8042968 0.7922469 0.7788925 0.7788925       0</span>
<span class="co">#&gt; 14: 0.8326518 0.8326518 0.8326518 0.8297624 0.8297624 0.8297624       0</span>
<span class="co">#&gt; 15: 0.8326518 0.8326518 0.8326518 0.8297624 0.8297624 0.8297624       0</span>
<span class="co">#&gt; 16: 0.5165280 0.5165280 0.5165280 0.3838650 0.2813386 0.2761015       0</span>
<span class="co">#&gt; 17: 0.5613828 0.5613828 0.5613828 0.5061578 0.4695346 0.4681200       0</span>
<span class="co">#&gt; 18: 0.5613828 0.5613828 0.5613828 0.5061578 0.4695346 0.4681200       0</span>
<span class="co">#&gt; 19: 0.7919672 0.7919672 0.7919672 0.7801021 0.7669524 0.7669524       0</span>
<span class="co">#&gt; 20: 0.8198876 0.8198876 0.8198876 0.8170425 0.8170425 0.8170425       0</span>
<span class="co">#&gt; 21: 0.8198876 0.8198876 0.8198876 0.8170425 0.8170425 0.8170425       0</span>
<span class="co">#&gt; 22: 0.5086098 0.5086098 0.5086098 0.3779805 0.2770257 0.2718689       0</span>
<span class="co">#&gt; 23: 0.5527770 0.5527770 0.5527770 0.4983986 0.4623369 0.4609439       0</span>
<span class="co">#&gt; 24: 0.5527770 0.5527770 0.5527770 0.4983986 0.4623369 0.4609439       0</span>
<span class="co">#&gt; 25: 0.7798267 0.7798267 0.7798267 0.7681434 0.7551953 0.7551953       0</span>
<span class="co">#&gt; 26: 0.8073190 0.8073190 0.8073190 0.8045175 0.8045175 0.8045175       0</span>
<span class="co">#&gt; 27: 0.8073190 0.8073190 0.8073190 0.8045175 0.8045175 0.8045175       0</span>
<span class="co">#&gt; 28: 0.5008130 0.5008130 0.5008130 0.3721862 0.2727790 0.2677013       0</span>
<span class="co">#&gt; 29: 0.5443031 0.5443031 0.5443031 0.4907583 0.4552494 0.4538778       0</span>
<span class="co">#&gt; 30: 0.5443031 0.5443031 0.5443031 0.4907583 0.4552494 0.4538778       0</span>
<span class="co">#&gt; 31: 0.7678722 0.7678722 0.7678722 0.7563681 0.7436185 0.7436185       0</span>
<span class="co">#&gt; 32: 0.7949432 0.7949432 0.7949432 0.7921846 0.7921846 0.7921846       0</span>
<span class="co">#&gt; 33: 0.7949432 0.7949432 0.7949432 0.7921846 0.7921846 0.7921846       0</span>
<span class="co">#&gt; 34: 0.4931358 0.4931358 0.4931358 0.3664808 0.2685974 0.2635975       0</span>
<span class="co">#&gt; 35: 0.5359592 0.5359592 0.5359592 0.4832352 0.4482706 0.4469200       0</span>
<span class="co">#&gt; 36: 0.5359592 0.5359592 0.5359592 0.4832352 0.4482706 0.4469200       0</span>
<span class="co">#&gt; 37: 0.7561010 0.7561010 0.7561010 0.7447732 0.7322191 0.7322191       0</span>
<span class="co">#&gt; 38: 0.7827570 0.7827570 0.7827570 0.7800407 0.7800407 0.7800407       0</span>
<span class="co">#&gt; 39: 0.7827570 0.7827570 0.7827570 0.7800407 0.7800407 0.7800407       0</span>
<span class="co">#&gt; 40: 0.4855762 0.4855762 0.4855762 0.3608627 0.2644800 0.2595567       0</span>
<span class="co">#&gt; 41: 0.5277431 0.5277431 0.5277431 0.4758274 0.4413988 0.4400689       0</span>
<span class="co">#&gt; 42: 0.5277431 0.5277431 0.5277431 0.4758274 0.4413988 0.4400689       0</span>
<span class="co">#&gt; 43: 0.7445103 0.7445103 0.7445103 0.7333561 0.7209945 0.7209945       0</span>
<span class="co">#&gt; 44: 0.7707576 0.7707576 0.7707576 0.7680830 0.7680830 0.7680830       0</span>
<span class="co">#&gt; 45: 0.7707576 0.7707576 0.7707576 0.7680830 0.7680830 0.7680830       0</span>
<span class="co">#&gt;            99       100       101       102       103       104 104.001</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-does-mcboost-do">What does mcboost do?<a class="anchor" aria-label="anchor" href="#what-does-mcboost-do"></a>
</h2>
<p>Internally mcboostsurv runs the following procedure <code>max_iter</code> times (similar ro <code>mcboost</code>, just for distributions over time):</p>
<ol style="list-style-type: decimal">
<li>Predict on X using the model from the previous iteration, <code>init_predictor</code> in the first iteration.</li>
<li>Compute the residuals <code>res = y - y_hat</code> for all time points</li>
<li>Split predictions into <code>num_buckets</code> according to <code>y_hat</code> and time.</li>
<li>Fit the auditor (<code>auditor_fitter</code>) (here called<code>c(x)</code>) on the data in each bucket with target variable <code>r</code>.</li>
<li>Compute <code>misscal = mean(c(x) * res(x))</code>
</li>
<li>if <code>misscal &gt; alpha</code>: For the bucket with highest <code>misscal</code>, update the model using the prediction <code>c(x)</code>. else: Stop the procedure</li>
</ol>
</div>
<div class="section level2">
<h2 id="multicalibrate-model-trained-on-pbc-data">Multicalibrate model trained on PBC data<a class="anchor" aria-label="anchor" href="#multicalibrate-model-trained-on-pbc-data"></a>
</h2>
<p>Based on this, we can now show multicalibration on a data set with two sensitive attributes (age and gender). Again, we load and pre-process the data.</p>
<div class="section level3">
<h3 id="load-dataset">Load Dataset<a class="anchor" aria-label="anchor" href="#load-dataset"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
<span class="va">data_pbc</span> <span class="op">=</span> <span class="va">pbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">task_pbc</span> <span class="op">=</span> <span class="va"><a href="https://mlr3proba.mlr-org.com/reference/TaskSurv.html" class="external-link">TaskSurv</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"pbc"</span>, backend <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_data_backend.html" class="external-link">as_data_backend</a></span><span class="op">(</span><span class="va">data_pbc</span><span class="op">)</span>, 
                        time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span><span class="op">)</span>


<span class="co">#Create data split</span>

<span class="va">train_test</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"holdout"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">$</span><span class="fu">instantiate</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">)</span>
<span class="va">train_g</span> <span class="op">=</span> <span class="va">train_test</span><span class="op">$</span><span class="fu">train_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">test_ids</span> <span class="op">=</span> <span class="va">train_test</span><span class="op">$</span><span class="fu">test_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">train_val</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"holdout"</span>, ratio <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">$</span><span class="fu">instantiate</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">train_g</span><span class="op">)</span><span class="op">)</span>
<span class="va">train_ids</span> <span class="op">=</span> <span class="va">train_val</span><span class="op">$</span><span class="fu">train_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">val_ids</span> <span class="op">=</span> <span class="va">train_val</span><span class="op">$</span><span class="fu">test_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Train distributional survival model </span>

<span class="va">xgb_distr</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="fu"><a href="https://mlr3pipelines.mlr-org.com//reference/ppl.html" class="external-link">ppl</a></span><span class="op">(</span><span class="st">"distrcompositor"</span>,
               learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"surv.xgboost"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">xgb_distr</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">train_ids</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mutlicalibrate-survival-model-with-validation-data">Mutlicalibrate survival model with validation data<a class="anchor" aria-label="anchor" href="#mutlicalibrate-survival-model-with-validation-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize mcboost</span>
 <span class="va">mcboost_learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span>
   <span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/ppl_mcboostsurv.html">ppl_mcboostsurv</a></span><span class="op">(</span>
     learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="va">xgb_distr</span><span class="op">)</span>, 
     param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
       alpha <span class="op">=</span> <span class="fl">1e-6</span>,
       eta <span class="op">=</span> <span class="fl">0.2</span>,
       time_buckets <span class="op">=</span> <span class="fl">2</span>,
       num_buckets <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="co"># multicalibrate model</span>
<span class="va">mcboost_learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">val_ids</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get new predictions</span>
<span class="va">test_task</span> <span class="op">=</span> <span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span>
<span class="va">pred_pbc_mc</span> <span class="op">=</span> <span class="va">mcboost_learner</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span><span class="op">)</span>

<span class="va">pred_pbc_xgb</span> <span class="op">=</span> <span class="va">xgb_distr</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development-of-ibs-in-the-defined-subgroups">Development of IBS in the defined subgroups<a class="anchor" aria-label="anchor" href="#development-of-ibs-in-the-defined-subgroups"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">pred_pbc_xgb</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"surv.graf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; surv.graf </span>
<span class="co">#&gt; 0.3742232</span>
<span class="va">pred_pbc_mc</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"surv.graf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; surv.graf </span>
<span class="co">#&gt; 0.3495244</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Florian Pfisterer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
