<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MCBoostSurv - Basics • mcboost</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MCBoostSurv - Basics">
<meta property="og:description" content="mcboost">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcboost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mcboost_basics_extensions.html">MCBoost - Basics and Extensions</a>
    </li>
    <li>
      <a href="../articles/mcboost_example.html">MCBoost - Health Survey Example</a>
    </li>
    <li>
      <a href="../articles/mcboostsurv_basics.html">MCBoostSurv - Basics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mcboost/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mcboostsurv_basics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MCBoostSurv - Basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mcboost/blob/HEAD/vignettes/mcboostsurv_basics.Rmd" class="external-link"><code>vignettes/mcboostsurv_basics.Rmd</code></a></small>
      <div class="hidden name"><code>mcboostsurv_basics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mlr-org/mcboost" class="external-link">"mcboost"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3.mlr-org.com" class="external-link">"mlr3"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3proba.mlr-org.com" class="external-link">"mlr3proba"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3pipelines.mlr-org.com" class="external-link">"mlr3pipelines"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com" class="external-link">"mlr3learners"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.9</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27099</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="minimal-example-mcboostsurv">Minimal Example: McBoostSurv<a class="anchor" aria-label="anchor" href="#minimal-example-mcboostsurv"></a>
</h2>
<p>To show the basic functionality of <code>MCBoostSurv</code>, we provide a minimal example on the standard survival data set rats. After loading and pre-processing the data, we train a <code>mlr3learner</code> on the training data. We instantiate a <code>MCBoostSurv</code> instance with the default parameters. Then, we run the <code>$multicalibrate()</code> method on our data to start multi-calibration in survival analysis. With <code>$predict_probs()</code>, we can get multicalibrated predictions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#prepare task </span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tsk</a></span><span class="op">(</span><span class="st">"rats"</span><span class="op">)</span>
<span class="va">prep_pipe</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com//reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"encode"</span>, param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"one-hot"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">prep</span> <span class="op">=</span> <span class="va">prep_pipe</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="co">#split data</span>
<span class="va">train</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">199</span><span class="op">)</span>
<span class="va">val</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">200</span><span class="op">:</span><span class="fl">250</span><span class="op">)</span>
<span class="va">test</span> <span class="op">=</span> <span class="va">prep</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="fl">256</span><span class="op">:</span><span class="fl">300</span><span class="op">)</span>

<span class="co"># get trained survival model </span>
<span class="va">baseline</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"surv.ranger"</span><span class="op">)</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">train</span><span class="op">)</span>

<span class="co"># initialize mcboost</span>
<span class="va">mc_surv</span> <span class="op">=</span> <span class="va"><a href="../reference/MCBoostSurv.html">MCBoostSurv</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>init_predictor <span class="op">=</span> <span class="va">baseline</span><span class="op">)</span>

<span class="co"># multicalibrate model </span>
<span class="va">mc_surv</span><span class="op">$</span><span class="fu">multicalibrate</span><span class="op">(</span>data <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">feature_names</span><span class="op">)</span>, 
                       labels <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">target_names</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get new predictions</span>
<span class="va">mc_surv</span><span class="op">$</span><span class="fu">predict_probs</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">feature_names</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     23        32        34        39        40        45        49        50</span>
<span class="co">#&gt;  1:  1 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547</span>
<span class="co">#&gt;  2:  1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  3:  1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  4:  1 0.8724312 0.8332370 0.8282864 0.8270594 0.8270594 0.8260787 0.8247643</span>
<span class="co">#&gt;  5:  1 0.9521705 0.9454486 0.9441695 0.9389009 0.9389009 0.9365322 0.9333110</span>
<span class="co">#&gt;  6:  1 0.9521705 0.9454486 0.9441695 0.9389009 0.9389009 0.9365322 0.9333110</span>
<span class="co">#&gt;  7:  1 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331</span>
<span class="co">#&gt;  8:  1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  9:  1 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt; 10:  1 0.8589496 0.8203611 0.8154870 0.8142789 0.8142789 0.8133134 0.8120193</span>
<span class="co">#&gt; 11:  1 0.9374567 0.9308386 0.9295793 0.9243921 0.9243921 0.9220600 0.9188886</span>
<span class="co">#&gt; 12:  1 0.9374567 0.9308386 0.9295793 0.9243921 0.9243921 0.9220600 0.9188886</span>
<span class="co">#&gt; 13:  1 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345</span>
<span class="co">#&gt; 14:  1 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171</span>
<span class="co">#&gt; 15:  1 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171</span>
<span class="co">#&gt; 16:  1 0.8456763 0.8076841 0.8028853 0.8016959 0.8016959 0.8007453 0.7994712</span>
<span class="co">#&gt; 17:  1 0.9229702 0.9164544 0.9152146 0.9101076 0.9101076 0.9078115 0.9046891</span>
<span class="co">#&gt; 18:  1 0.9229702 0.9164544 0.9152146 0.9101076 0.9101076 0.9078115 0.9046891</span>
<span class="co">#&gt; 19:  1 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552</span>
<span class="co">#&gt; 20:  1 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601</span>
<span class="co">#&gt; 21:  1 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601</span>
<span class="co">#&gt; 22:  1 0.8326081 0.7952030 0.7904784 0.7893074 0.7893074 0.7883715 0.7871171</span>
<span class="co">#&gt; 23:  1 0.9087076 0.9022925 0.9010718 0.8960437 0.8960437 0.8937831 0.8907090</span>
<span class="co">#&gt; 24:  1 0.9087076 0.9022925 0.9010718 0.8960437 0.8960437 0.8937831 0.8907090</span>
<span class="co">#&gt; 25:  1 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920</span>
<span class="co">#&gt; 26:  1 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389</span>
<span class="co">#&gt; 27:  1 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389</span>
<span class="co">#&gt; 28:  1 0.8197419 0.7829148 0.7782632 0.7771102 0.7771102 0.7761888 0.7749538</span>
<span class="co">#&gt; 29:  1 0.8946654 0.8883495 0.8871476 0.8821972 0.8821972 0.8799716 0.8769449</span>
<span class="co">#&gt; 30:  1 0.8946654 0.8883495 0.8871476 0.8821972 0.8821972 0.8799716 0.8769449</span>
<span class="co">#&gt; 31:  1 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414</span>
<span class="co">#&gt; 32:  1 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499</span>
<span class="co">#&gt; 33:  1 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499</span>
<span class="co">#&gt; 34:  1 0.8070745 0.7708164 0.7662367 0.7651016 0.7651016 0.7641944 0.7629785</span>
<span class="co">#&gt; 35:  1 0.8808402 0.8746218 0.8734386 0.8685647 0.8685647 0.8663734 0.8633936</span>
<span class="co">#&gt; 36:  1 0.8808402 0.8746218 0.8734386 0.8685647 0.8685647 0.8663734 0.8633936</span>
<span class="co">#&gt; 37:  1 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003</span>
<span class="co">#&gt; 38:  1 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893</span>
<span class="co">#&gt; 39:  1 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893</span>
<span class="co">#&gt; 40:  1 0.7946028 0.7589051 0.7543961 0.7532785 0.7532785 0.7523854 0.7511882</span>
<span class="co">#&gt; 41:  1 0.8672286 0.8611064 0.8599414 0.8551428 0.8551428 0.8529854 0.8500516</span>
<span class="co">#&gt; 42:  1 0.8672286 0.8611064 0.8599414 0.8551428 0.8551428 0.8529854 0.8500516</span>
<span class="co">#&gt; 43:  1 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653</span>
<span class="co">#&gt; 44:  1 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538</span>
<span class="co">#&gt; 45:  1 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538</span>
<span class="co">#&gt;     23        32        34        39        40        45        49        50</span>
<span class="co">#&gt;            51        53        54        55        61        62        63</span>
<span class="co">#&gt;  1: 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547</span>
<span class="co">#&gt;  2: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  3: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  4: 0.8247643 0.8247643 0.8188109 0.8145182 0.8145182 0.8145182 0.8145182</span>
<span class="co">#&gt;  5: 0.9333110 0.9333110 0.9057849 0.8857097 0.8857097 0.8857097 0.8857097</span>
<span class="co">#&gt;  6: 0.9333110 0.9333110 0.9057849 0.8857097 0.8857097 0.8857097 0.8857097</span>
<span class="co">#&gt;  7: 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331</span>
<span class="co">#&gt;  8: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt;  9: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="co">#&gt; 10: 0.8120193 0.8120193 0.8061579 0.8019315 0.8019315 0.8019315 0.8019315</span>
<span class="co">#&gt; 11: 0.9188886 0.9188886 0.8917878 0.8720229 0.8720229 0.8720229 0.8720229</span>
<span class="co">#&gt; 12: 0.9188886 0.9188886 0.8917878 0.8720229 0.8720229 0.8720229 0.8720229</span>
<span class="co">#&gt; 13: 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345</span>
<span class="co">#&gt; 14: 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171</span>
<span class="co">#&gt; 15: 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171</span>
<span class="co">#&gt; 16: 0.7994712 0.7994712 0.7937004 0.7895393 0.7895393 0.7895393 0.7895393</span>
<span class="co">#&gt; 17: 0.9046891 0.9046891 0.8780071 0.8585476 0.8585476 0.8585476 0.8585476</span>
<span class="co">#&gt; 18: 0.9046891 0.9046891 0.8780071 0.8585476 0.8585476 0.8585476 0.8585476</span>
<span class="co">#&gt; 19: 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552</span>
<span class="co">#&gt; 20: 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601</span>
<span class="co">#&gt; 21: 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601</span>
<span class="co">#&gt; 22: 0.7871171 0.7871171 0.7814354 0.7773386 0.7773386 0.7773386 0.7773386</span>
<span class="co">#&gt; 23: 0.8907090 0.8907090 0.8644393 0.8452805 0.8452805 0.8452805 0.8452805</span>
<span class="co">#&gt; 24: 0.8907090 0.8907090 0.8644393 0.8452805 0.8452805 0.8452805 0.8452805</span>
<span class="co">#&gt; 25: 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920</span>
<span class="co">#&gt; 26: 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389</span>
<span class="co">#&gt; 27: 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389</span>
<span class="co">#&gt; 28: 0.7749538 0.7749538 0.7693599 0.7653264 0.7653264 0.7653264 0.7653264</span>
<span class="co">#&gt; 29: 0.8769449 0.8769449 0.8510812 0.8322184 0.8322184 0.8322184 0.8322184</span>
<span class="co">#&gt; 30: 0.8769449 0.8769449 0.8510812 0.8322184 0.8322184 0.8322184 0.8322184</span>
<span class="co">#&gt; 31: 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414</span>
<span class="co">#&gt; 32: 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499</span>
<span class="co">#&gt; 33: 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499</span>
<span class="co">#&gt; 34: 0.7629785 0.7629785 0.7574711 0.7534999 0.7534999 0.7534999 0.7534999</span>
<span class="co">#&gt; 35: 0.8633936 0.8633936 0.8379295 0.8193582 0.8193582 0.8193582 0.8193582</span>
<span class="co">#&gt; 36: 0.8633936 0.8633936 0.8379295 0.8193582 0.8193582 0.8193582 0.8193582</span>
<span class="co">#&gt; 37: 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003</span>
<span class="co">#&gt; 38: 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893</span>
<span class="co">#&gt; 39: 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893</span>
<span class="co">#&gt; 40: 0.7511882 0.7511882 0.7457659 0.7418561 0.7418561 0.7418561 0.7418561</span>
<span class="co">#&gt; 41: 0.8500516 0.8500516 0.8249810 0.8066967 0.8066967 0.8066967 0.8066967</span>
<span class="co">#&gt; 42: 0.8500516 0.8500516 0.8249810 0.8066967 0.8066967 0.8066967 0.8066967</span>
<span class="co">#&gt; 43: 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653</span>
<span class="co">#&gt; 44: 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538</span>
<span class="co">#&gt; 45: 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538</span>
<span class="co">#&gt;            51        53        54        55        61        62        63</span>
<span class="co">#&gt;            64        65        67        68        69        70        71</span>
<span class="co">#&gt;  1: 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.9332547 0.8682590</span>
<span class="co">#&gt;  2: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.8979023</span>
<span class="co">#&gt;  3: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.8979023</span>
<span class="co">#&gt;  4: 0.8089092 0.8089092 0.8035126 0.8022775 0.8022775 0.7969921 0.7953719</span>
<span class="co">#&gt;  5: 0.8629998 0.8629998 0.8619634 0.8573172 0.8573172 0.8562287 0.8497973</span>
<span class="co">#&gt;  6: 0.8629998 0.8629998 0.8619634 0.8573172 0.8573172 0.8562287 0.8497973</span>
<span class="co">#&gt;  7: 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.9188331 0.8548418</span>
<span class="co">#&gt;  8: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.8840270</span>
<span class="co">#&gt;  9: 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.8840270</span>
<span class="co">#&gt; 10: 0.7964092 0.7964092 0.7910959 0.7898800 0.7898800 0.7846762 0.7830811</span>
<span class="co">#&gt; 11: 0.8496639 0.8496639 0.8486435 0.8440692 0.8440692 0.8429975 0.8366654</span>
<span class="co">#&gt; 12: 0.8496639 0.8496639 0.8486435 0.8440692 0.8440692 0.8429975 0.8366654</span>
<span class="co">#&gt; 13: 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.9046345 0.8416320</span>
<span class="co">#&gt; 14: 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.8703662</span>
<span class="co">#&gt; 15: 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.9873171 0.8703662</span>
<span class="co">#&gt; 16: 0.7841023 0.7841023 0.7788712 0.7776740 0.7776740 0.7725507 0.7709802</span>
<span class="co">#&gt; 17: 0.8365341 0.8365341 0.8355295 0.8310258 0.8310258 0.8299707 0.8237365</span>
<span class="co">#&gt; 18: 0.8365341 0.8365341 0.8355295 0.8310258 0.8310258 0.8299707 0.8237365</span>
<span class="co">#&gt; 19: 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8906552 0.8286263</span>
<span class="co">#&gt; 20: 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.8569165</span>
<span class="co">#&gt; 21: 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.9720601 0.8569165</span>
<span class="co">#&gt; 22: 0.7719856 0.7719856 0.7668353 0.7656567 0.7656567 0.7606125 0.7590663</span>
<span class="co">#&gt; 23: 0.8236072 0.8236072 0.8226181 0.8181840 0.8181840 0.8171452 0.8110074</span>
<span class="co">#&gt; 24: 0.8236072 0.8236072 0.8226181 0.8181840 0.8181840 0.8171452 0.8110074</span>
<span class="co">#&gt; 25: 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8768920 0.8158216</span>
<span class="co">#&gt; 26: 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.8436746</span>
<span class="co">#&gt; 27: 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.9570389 0.8436746</span>
<span class="co">#&gt; 28: 0.7600562 0.7600562 0.7549855 0.7538250 0.7538250 0.7488588 0.7473365</span>
<span class="co">#&gt; 29: 0.8108800 0.8108800 0.8099062 0.8055407 0.8055407 0.8045179 0.7984749</span>
<span class="co">#&gt; 30: 0.8108800 0.8108800 0.8099062 0.8055407 0.8055407 0.8045179 0.7984749</span>
<span class="co">#&gt; 31: 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8633414 0.8032148</span>
<span class="co">#&gt; 32: 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.8306374</span>
<span class="co">#&gt; 33: 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.9422499 0.8306374</span>
<span class="co">#&gt; 34: 0.7483111 0.7483111 0.7433187 0.7421762 0.7421762 0.7372867 0.7357879</span>
<span class="co">#&gt; 35: 0.7983495 0.7983495 0.7973908 0.7930927 0.7930927 0.7920858 0.7861361</span>
<span class="co">#&gt; 36: 0.7983495 0.7983495 0.7973908 0.7930927 0.7930927 0.7920858 0.7861361</span>
<span class="co">#&gt; 37: 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.8500003 0.7908027</span>
<span class="co">#&gt; 38: 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.8178016</span>
<span class="co">#&gt; 39: 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.9276893 0.8178016</span>
<span class="co">#&gt; 40: 0.7367475 0.7367475 0.7318323 0.7307074 0.7307074 0.7258935 0.7244178</span>
<span class="co">#&gt; 41: 0.7860127 0.7860127 0.7850688 0.7808371 0.7808371 0.7798457 0.7739880</span>
<span class="co">#&gt; 42: 0.7860127 0.7860127 0.7850688 0.7808371 0.7808371 0.7798457 0.7739880</span>
<span class="co">#&gt; 43: 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.8368653 0.7785825</span>
<span class="co">#&gt; 44: 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.8051642</span>
<span class="co">#&gt; 45: 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.9133538 0.8051642</span>
<span class="co">#&gt;            64        65        67        68        69        70        71</span>
<span class="co">#&gt;            72        73        74        75        76        77        78</span>
<span class="co">#&gt;  1: 0.8682590 0.8679117 0.8679117 0.8679117 0.8679117 0.8679117 0.8679117</span>
<span class="co">#&gt;  2: 0.8979023 0.8948844 0.8948844 0.8948844 0.8948844 0.8948844 0.8948844</span>
<span class="co">#&gt;  3: 0.8979023 0.8948844 0.8948844 0.8948844 0.8948844 0.8948844 0.8948844</span>
<span class="co">#&gt;  4: 0.7953719 0.7744792 0.7744792 0.7744792 0.7744792 0.7733153 0.7733153</span>
<span class="co">#&gt;  5: 0.8497973 0.7874829 0.7874829 0.7874829 0.7874829 0.7841595 0.7841595</span>
<span class="co">#&gt;  6: 0.8497973 0.7874829 0.7874829 0.7874829 0.7874829 0.7841595 0.7841595</span>
<span class="co">#&gt;  7: 0.8548418 0.8544999 0.8544999 0.8544999 0.8544999 0.8544999 0.8544999</span>
<span class="co">#&gt;  8: 0.8840270 0.8810558 0.8810558 0.8810558 0.8810558 0.8810558 0.8810558</span>
<span class="co">#&gt;  9: 0.8840270 0.8810558 0.8810558 0.8810558 0.8810558 0.8810558 0.8810558</span>
<span class="co">#&gt; 10: 0.7830811 0.7625113 0.7625113 0.7625113 0.7625113 0.7613653 0.7613653</span>
<span class="co">#&gt; 11: 0.8366654 0.7753140 0.7753140 0.7753140 0.7753140 0.7720419 0.7720419</span>
<span class="co">#&gt; 12: 0.8366654 0.7753140 0.7753140 0.7753140 0.7753140 0.7720419 0.7720419</span>
<span class="co">#&gt; 13: 0.8416320 0.8412954 0.8412954 0.8412954 0.8412954 0.8412954 0.8412954</span>
<span class="co">#&gt; 14: 0.8703662 0.8674409 0.8674409 0.8674409 0.8674409 0.8674409 0.8674409</span>
<span class="co">#&gt; 15: 0.8703662 0.8674409 0.8674409 0.8674409 0.8674409 0.8674409 0.8674409</span>
<span class="co">#&gt; 16: 0.7709802 0.7507282 0.7507282 0.7507282 0.7507282 0.7495999 0.7495999</span>
<span class="co">#&gt; 17: 0.8237365 0.7633331 0.7633331 0.7633331 0.7633331 0.7601116 0.7601116</span>
<span class="co">#&gt; 18: 0.8237365 0.7633331 0.7633331 0.7633331 0.7633331 0.7601116 0.7601116</span>
<span class="co">#&gt; 19: 0.8286263 0.8282949 0.8282949 0.8282949 0.8282949 0.8282949 0.8282949</span>
<span class="co">#&gt; 20: 0.8569165 0.8540364 0.8540364 0.8540364 0.8540364 0.8540364 0.8540364</span>
<span class="co">#&gt; 21: 0.8569165 0.8540364 0.8540364 0.8540364 0.8540364 0.8540364 0.8540364</span>
<span class="co">#&gt; 22: 0.7590663 0.7391273 0.7391273 0.7391273 0.7391273 0.7380164 0.7380164</span>
<span class="co">#&gt; 23: 0.8110074 0.7515374 0.7515374 0.7515374 0.7515374 0.7483657 0.7483657</span>
<span class="co">#&gt; 24: 0.8110074 0.7515374 0.7515374 0.7515374 0.7515374 0.7483657 0.7483657</span>
<span class="co">#&gt; 25: 0.8158216 0.8154953 0.8154953 0.8154953 0.8154953 0.8154953 0.8154953</span>
<span class="co">#&gt; 26: 0.8436746 0.8408390 0.8408390 0.8408390 0.8408390 0.8408390 0.8408390</span>
<span class="co">#&gt; 27: 0.8436746 0.8408390 0.8408390 0.8408390 0.8408390 0.8408390 0.8408390</span>
<span class="co">#&gt; 28: 0.7473365 0.7277056 0.7277056 0.7277056 0.7277056 0.7266119 0.7266119</span>
<span class="co">#&gt; 29: 0.7984749 0.7399239 0.7399239 0.7399239 0.7399239 0.7368012 0.7368012</span>
<span class="co">#&gt; 30: 0.7984749 0.7399239 0.7399239 0.7399239 0.7399239 0.7368012 0.7368012</span>
<span class="co">#&gt; 31: 0.8032148 0.8028935 0.8028935 0.8028935 0.8028935 0.8028935 0.8028935</span>
<span class="co">#&gt; 32: 0.8306374 0.8278456 0.8278456 0.8278456 0.8278456 0.8278456 0.8278456</span>
<span class="co">#&gt; 33: 0.8306374 0.8278456 0.8278456 0.8278456 0.8278456 0.8278456 0.8278456</span>
<span class="co">#&gt; 34: 0.7357879 0.7164604 0.7164604 0.7164604 0.7164604 0.7153836 0.7153836</span>
<span class="co">#&gt; 35: 0.7861361 0.7284899 0.7284899 0.7284899 0.7284899 0.7254155 0.7254155</span>
<span class="co">#&gt; 36: 0.7861361 0.7284899 0.7284899 0.7284899 0.7284899 0.7254155 0.7254155</span>
<span class="co">#&gt; 37: 0.7908027 0.7904865 0.7904865 0.7904865 0.7904865 0.7904865 0.7904865</span>
<span class="co">#&gt; 38: 0.8178016 0.8150530 0.8150530 0.8150530 0.8150530 0.8150530 0.8150530</span>
<span class="co">#&gt; 39: 0.8178016 0.8150530 0.8150530 0.8150530 0.8150530 0.8150530 0.8150530</span>
<span class="co">#&gt; 40: 0.7244178 0.7053890 0.7053890 0.7053890 0.7053890 0.7043288 0.7043288</span>
<span class="co">#&gt; 41: 0.7739880 0.7172326 0.7172326 0.7172326 0.7172326 0.7142057 0.7142057</span>
<span class="co">#&gt; 42: 0.7739880 0.7172326 0.7172326 0.7172326 0.7172326 0.7142057 0.7142057</span>
<span class="co">#&gt; 43: 0.7785825 0.7782711 0.7782711 0.7782711 0.7782711 0.7782711 0.7782711</span>
<span class="co">#&gt; 44: 0.8051642 0.8024580 0.8024580 0.8024580 0.8024580 0.8024580 0.8024580</span>
<span class="co">#&gt; 45: 0.8051642 0.8024580 0.8024580 0.8024580 0.8024580 0.8024580 0.8024580</span>
<span class="co">#&gt;            72        73        74        75        76        77        78</span>
<span class="co">#&gt;            79        80        81        82        83        84        85</span>
<span class="co">#&gt;  1: 0.8679117 0.8306821 0.8306821 0.8306821 0.8306821 0.8296029 0.8296029</span>
<span class="co">#&gt;  2: 0.8948844 0.8642163 0.8642163 0.8642163 0.8642163 0.8593043 0.8593043</span>
<span class="co">#&gt;  3: 0.8948844 0.8642163 0.8642163 0.8642163 0.8642163 0.8593043 0.8593043</span>
<span class="co">#&gt;  4: 0.7733153 0.6303874 0.6242257 0.6242257 0.6242257 0.5932304 0.5932304</span>
<span class="co">#&gt;  5: 0.7841595 0.7191789 0.6928114 0.6928114 0.6928114 0.5928516 0.5928516</span>
<span class="co">#&gt;  6: 0.7841595 0.7191789 0.6928114 0.6928114 0.6928114 0.5928516 0.5928516</span>
<span class="co">#&gt;  7: 0.8544999 0.8178456 0.8178456 0.8178456 0.8178456 0.8167831 0.8167831</span>
<span class="co">#&gt;  8: 0.8810558 0.8508617 0.8508617 0.8508617 0.8508617 0.8460255 0.8460255</span>
<span class="co">#&gt;  9: 0.8810558 0.8508617 0.8508617 0.8508617 0.8508617 0.8460255 0.8460255</span>
<span class="co">#&gt; 10: 0.7613653 0.6206461 0.6145796 0.6145796 0.6145796 0.5840633 0.5840633</span>
<span class="co">#&gt; 11: 0.7720419 0.7080655 0.6821054 0.6821054 0.6821054 0.5836903 0.5836903</span>
<span class="co">#&gt; 12: 0.7720419 0.7080655 0.6821054 0.6821054 0.6821054 0.5836903 0.5836903</span>
<span class="co">#&gt; 13: 0.8412954 0.8052075 0.8052075 0.8052075 0.8052075 0.8041614 0.8041614</span>
<span class="co">#&gt; 14: 0.8674409 0.8377133 0.8377133 0.8377133 0.8377133 0.8329520 0.8329520</span>
<span class="co">#&gt; 15: 0.8674409 0.8377133 0.8377133 0.8377133 0.8377133 0.8329520 0.8329520</span>
<span class="co">#&gt; 16: 0.7495999 0.6110553 0.6050826 0.6050826 0.6050826 0.5750378 0.5750378</span>
<span class="co">#&gt; 17: 0.7601116 0.6971238 0.6715649 0.6715649 0.6715649 0.5746706 0.5746706</span>
<span class="co">#&gt; 18: 0.7601116 0.6971238 0.6715649 0.6715649 0.6715649 0.5746706 0.5746706</span>
<span class="co">#&gt; 19: 0.8282949 0.7927647 0.7927647 0.7927647 0.7927647 0.7917348 0.7917348</span>
<span class="co">#&gt; 20: 0.8540364 0.8247682 0.8247682 0.8247682 0.8247682 0.8200804 0.8200804</span>
<span class="co">#&gt; 21: 0.8540364 0.8247682 0.8247682 0.8247682 0.8247682 0.8200804 0.8200804</span>
<span class="co">#&gt; 22: 0.7380164 0.6016127 0.5957323 0.5957323 0.5957323 0.5661518 0.5661518</span>
<span class="co">#&gt; 23: 0.7483657 0.6863512 0.6611872 0.6611872 0.6611872 0.5657903 0.5657903</span>
<span class="co">#&gt; 24: 0.7483657 0.6863512 0.6611872 0.6611872 0.6611872 0.5657903 0.5657903</span>
<span class="co">#&gt; 25: 0.8154953 0.7805141 0.7805141 0.7805141 0.7805141 0.7795001 0.7795001</span>
<span class="co">#&gt; 26: 0.8408390 0.8120231 0.8120231 0.8120231 0.8120231 0.8074078 0.8074078</span>
<span class="co">#&gt; 27: 0.8408390 0.8120231 0.8120231 0.8120231 0.8120231 0.8074078 0.8074078</span>
<span class="co">#&gt; 28: 0.7266119 0.5923160 0.5865265 0.5865265 0.5865265 0.5574030 0.5574030</span>
<span class="co">#&gt; 29: 0.7368012 0.6757451 0.6509700 0.6509700 0.6509700 0.5570471 0.5570471</span>
<span class="co">#&gt; 30: 0.7368012 0.6757451 0.6509700 0.6509700 0.6509700 0.5570471 0.5570471</span>
<span class="co">#&gt; 31: 0.8028935 0.7684529 0.7684529 0.7684529 0.7684529 0.7674546 0.7674546</span>
<span class="co">#&gt; 32: 0.8278456 0.7994750 0.7994750 0.7994750 0.7994750 0.7949309 0.7949309</span>
<span class="co">#&gt; 33: 0.8278456 0.7994750 0.7994750 0.7994750 0.7994750 0.7949309 0.7949309</span>
<span class="co">#&gt; 34: 0.7153836 0.5831630 0.5774629 0.5774629 0.5774629 0.5487895 0.5487895</span>
<span class="co">#&gt; 35: 0.7254155 0.6653028 0.6409106 0.6409106 0.6409106 0.5484391 0.5484391</span>
<span class="co">#&gt; 36: 0.7254155 0.6653028 0.6409106 0.6409106 0.6409106 0.5484391 0.5484391</span>
<span class="co">#&gt; 37: 0.7904865 0.7565780 0.7565780 0.7565780 0.7565780 0.7555951 0.7555951</span>
<span class="co">#&gt; 38: 0.8150530 0.7871208 0.7871208 0.7871208 0.7871208 0.7826469 0.7826469</span>
<span class="co">#&gt; 39: 0.8150530 0.7871208 0.7871208 0.7871208 0.7871208 0.7826469 0.7826469</span>
<span class="co">#&gt; 40: 0.7043288 0.5741514 0.5685394 0.5685394 0.5685394 0.5403091 0.5403091</span>
<span class="co">#&gt; 41: 0.7142057 0.6550219 0.6310066 0.6310066 0.6310066 0.5399641 0.5399641</span>
<span class="co">#&gt; 42: 0.7142057 0.6550219 0.6310066 0.6310066 0.6310066 0.5399641 0.5399641</span>
<span class="co">#&gt; 43: 0.7782711 0.7448867 0.7448867 0.7448867 0.7448867 0.7439190 0.7439190</span>
<span class="co">#&gt; 44: 0.8024580 0.7749574 0.7749574 0.7749574 0.7749574 0.7705527 0.7705527</span>
<span class="co">#&gt; 45: 0.8024580 0.7749574 0.7749574 0.7749574 0.7749574 0.7705527 0.7705527</span>
<span class="co">#&gt;            79        80        81        82        83        84        85</span>
<span class="co">#&gt;            86        87        88        89        90        91        92</span>
<span class="co">#&gt;  1: 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029</span>
<span class="co">#&gt;  2: 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043</span>
<span class="co">#&gt;  3: 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043</span>
<span class="co">#&gt;  4: 0.5507482 0.5507482 0.5462807 0.5412907 0.5412907 0.5412907 0.5412907</span>
<span class="co">#&gt;  5: 0.5874939 0.5874939 0.5865021 0.5854216 0.5854216 0.5854216 0.5854216</span>
<span class="co">#&gt;  6: 0.5874939 0.5874939 0.5865021 0.5854216 0.5854216 0.5854216 0.5854216</span>
<span class="co">#&gt;  7: 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831</span>
<span class="co">#&gt;  8: 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255</span>
<span class="co">#&gt;  9: 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255</span>
<span class="co">#&gt; 10: 0.5422376 0.5422376 0.5378391 0.5329261 0.5329261 0.5329261 0.5329261</span>
<span class="co">#&gt; 11: 0.5784154 0.5784154 0.5774389 0.5763751 0.5763751 0.5763751 0.5763751</span>
<span class="co">#&gt; 12: 0.5784154 0.5784154 0.5774389 0.5763751 0.5763751 0.5763751 0.5763751</span>
<span class="co">#&gt; 13: 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614</span>
<span class="co">#&gt; 14: 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520</span>
<span class="co">#&gt; 15: 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520</span>
<span class="co">#&gt; 16: 0.5338584 0.5338584 0.5295279 0.5246909 0.5246909 0.5246909 0.5246909</span>
<span class="co">#&gt; 17: 0.5694772 0.5694772 0.5685158 0.5674684 0.5674684 0.5674684 0.5674684</span>
<span class="co">#&gt; 18: 0.5694772 0.5694772 0.5685158 0.5674684 0.5674684 0.5674684 0.5674684</span>
<span class="co">#&gt; 19: 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348</span>
<span class="co">#&gt; 20: 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804</span>
<span class="co">#&gt; 21: 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804</span>
<span class="co">#&gt; 22: 0.5256087 0.5256087 0.5213451 0.5165829 0.5165829 0.5165829 0.5165829</span>
<span class="co">#&gt; 23: 0.5606771 0.5606771 0.5597305 0.5586994 0.5586994 0.5586994 0.5586994</span>
<span class="co">#&gt; 24: 0.5606771 0.5606771 0.5597305 0.5586994 0.5586994 0.5586994 0.5586994</span>
<span class="co">#&gt; 25: 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001</span>
<span class="co">#&gt; 26: 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078</span>
<span class="co">#&gt; 27: 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078</span>
<span class="co">#&gt; 28: 0.5174865 0.5174865 0.5132888 0.5086001 0.5086001 0.5086001 0.5086001</span>
<span class="co">#&gt; 29: 0.5520130 0.5520130 0.5510810 0.5500658 0.5500658 0.5500658 0.5500658</span>
<span class="co">#&gt; 30: 0.5520130 0.5520130 0.5510810 0.5500658 0.5500658 0.5500658 0.5500658</span>
<span class="co">#&gt; 31: 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546</span>
<span class="co">#&gt; 32: 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309</span>
<span class="co">#&gt; 33: 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309</span>
<span class="co">#&gt; 34: 0.5094898 0.5094898 0.5053570 0.5007408 0.5007408 0.5007408 0.5007408</span>
<span class="co">#&gt; 35: 0.5434827 0.5434827 0.5425652 0.5415657 0.5415657 0.5415657 0.5415657</span>
<span class="co">#&gt; 36: 0.5434827 0.5434827 0.5425652 0.5415657 0.5415657 0.5415657 0.5415657</span>
<span class="co">#&gt; 37: 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951</span>
<span class="co">#&gt; 38: 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469</span>
<span class="co">#&gt; 39: 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469</span>
<span class="co">#&gt; 40: 0.5016167 0.5016167 0.4975478 0.4930029 0.4930029 0.4930029 0.4930029</span>
<span class="co">#&gt; 41: 0.5350843 0.5350843 0.5341810 0.5331969 0.5331969 0.5331969 0.5331969</span>
<span class="co">#&gt; 42: 0.5350843 0.5350843 0.5341810 0.5331969 0.5331969 0.5331969 0.5331969</span>
<span class="co">#&gt; 43: 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190</span>
<span class="co">#&gt; 44: 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527</span>
<span class="co">#&gt; 45: 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527</span>
<span class="co">#&gt;            86        87        88        89        90        91        92</span>
<span class="co">#&gt;            93        94        95        96        97        98        99</span>
<span class="co">#&gt;  1: 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029 0.8296029</span>
<span class="co">#&gt;  2: 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043</span>
<span class="co">#&gt;  3: 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043 0.8593043</span>
<span class="co">#&gt;  4: 0.5412907 0.5412907 0.5412907 0.5334002 0.5334002 0.5334002 0.5334002</span>
<span class="co">#&gt;  5: 0.5854216 0.5854216 0.5854216 0.5800267 0.5800267 0.5800267 0.5800267</span>
<span class="co">#&gt;  6: 0.5854216 0.5854216 0.5854216 0.5800267 0.5800267 0.5800267 0.5800267</span>
<span class="co">#&gt;  7: 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831 0.8167831</span>
<span class="co">#&gt;  8: 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255</span>
<span class="co">#&gt;  9: 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255 0.8460255</span>
<span class="co">#&gt; 10: 0.5329261 0.5329261 0.5329261 0.5251576 0.5251576 0.5251576 0.5251576</span>
<span class="co">#&gt; 11: 0.5763751 0.5763751 0.5763751 0.5710636 0.5710636 0.5710636 0.5710636</span>
<span class="co">#&gt; 12: 0.5763751 0.5763751 0.5763751 0.5710636 0.5710636 0.5710636 0.5710636</span>
<span class="co">#&gt; 13: 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614 0.8041614</span>
<span class="co">#&gt; 14: 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520</span>
<span class="co">#&gt; 15: 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520 0.8329520</span>
<span class="co">#&gt; 16: 0.5246909 0.5246909 0.5246909 0.5170424 0.5170424 0.5170424 0.5170424</span>
<span class="co">#&gt; 17: 0.5674684 0.5674684 0.5674684 0.5622390 0.5622390 0.5622390 0.5622390</span>
<span class="co">#&gt; 18: 0.5674684 0.5674684 0.5674684 0.5622390 0.5622390 0.5622390 0.5622390</span>
<span class="co">#&gt; 19: 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348 0.7917348</span>
<span class="co">#&gt; 20: 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804</span>
<span class="co">#&gt; 21: 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804 0.8200804</span>
<span class="co">#&gt; 22: 0.5165829 0.5165829 0.5165829 0.5090525 0.5090525 0.5090525 0.5090525</span>
<span class="co">#&gt; 23: 0.5586994 0.5586994 0.5586994 0.5535508 0.5535508 0.5535508 0.5535508</span>
<span class="co">#&gt; 24: 0.5586994 0.5586994 0.5586994 0.5535508 0.5535508 0.5535508 0.5535508</span>
<span class="co">#&gt; 25: 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001 0.7795001</span>
<span class="co">#&gt; 26: 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078</span>
<span class="co">#&gt; 27: 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078 0.8074078</span>
<span class="co">#&gt; 28: 0.5086001 0.5086001 0.5086001 0.5011862 0.5011862 0.5011862 0.5011862</span>
<span class="co">#&gt; 29: 0.5500658 0.5500658 0.5500658 0.5449968 0.5449968 0.5449968 0.5449968</span>
<span class="co">#&gt; 30: 0.5500658 0.5500658 0.5500658 0.5449968 0.5449968 0.5449968 0.5449968</span>
<span class="co">#&gt; 31: 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546 0.7674546</span>
<span class="co">#&gt; 32: 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309</span>
<span class="co">#&gt; 33: 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309 0.7949309</span>
<span class="co">#&gt; 34: 0.5007408 0.5007408 0.5007408 0.4934414 0.4934414 0.4934414 0.4934414</span>
<span class="co">#&gt; 35: 0.5415657 0.5415657 0.5415657 0.5365750 0.5365750 0.5365750 0.5365750</span>
<span class="co">#&gt; 36: 0.5415657 0.5415657 0.5415657 0.5365750 0.5365750 0.5365750 0.5365750</span>
<span class="co">#&gt; 37: 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951 0.7555951</span>
<span class="co">#&gt; 38: 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469</span>
<span class="co">#&gt; 39: 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469 0.7826469</span>
<span class="co">#&gt; 40: 0.4930029 0.4930029 0.4930029 0.4858163 0.4858163 0.4858163 0.4858163</span>
<span class="co">#&gt; 41: 0.5331969 0.5331969 0.5331969 0.5282833 0.5282833 0.5282833 0.5282833</span>
<span class="co">#&gt; 42: 0.5331969 0.5331969 0.5331969 0.5282833 0.5282833 0.5282833 0.5282833</span>
<span class="co">#&gt; 43: 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190 0.7439190</span>
<span class="co">#&gt; 44: 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527</span>
<span class="co">#&gt; 45: 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527 0.7705527</span>
<span class="co">#&gt;            93        94        95        96        97        98        99</span>
<span class="co">#&gt;           100       101       102       103 104</span>
<span class="co">#&gt;  1: 0.8296029 0.8296029 0.8171739 0.8033994   0</span>
<span class="co">#&gt;  2: 0.8593043 0.8593043 0.8563224 0.8563224   0</span>
<span class="co">#&gt;  3: 0.8593043 0.8593043 0.8563224 0.8563224   0</span>
<span class="co">#&gt;  4: 0.5334002 0.5334002 0.3964038 0.2905284   0</span>
<span class="co">#&gt;  5: 0.5800267 0.5800267 0.5229677 0.4851282   0</span>
<span class="co">#&gt;  6: 0.5800267 0.5800267 0.5229677 0.4851282   0</span>
<span class="co">#&gt;  7: 0.8167831 0.8167831 0.8045462 0.7909845   0</span>
<span class="co">#&gt;  8: 0.8460255 0.8460255 0.8430897 0.8430897   0</span>
<span class="co">#&gt;  9: 0.8460255 0.8460255 0.8430897 0.8430897   0</span>
<span class="co">#&gt; 10: 0.5251576 0.5251576 0.3902782 0.2860389   0</span>
<span class="co">#&gt; 11: 0.5710636 0.5710636 0.5148863 0.4776316   0</span>
<span class="co">#&gt; 12: 0.5710636 0.5710636 0.5148863 0.4776316   0</span>
<span class="co">#&gt; 13: 0.8041614 0.8041614 0.7921136 0.7787614   0</span>
<span class="co">#&gt; 14: 0.8329520 0.8329520 0.8300615 0.8300615   0</span>
<span class="co">#&gt; 15: 0.8329520 0.8329520 0.8300615 0.8300615   0</span>
<span class="co">#&gt; 16: 0.5170424 0.5170424 0.3842473 0.2816187   0</span>
<span class="co">#&gt; 17: 0.5622390 0.5622390 0.5069298 0.4702508   0</span>
<span class="co">#&gt; 18: 0.5622390 0.5622390 0.5069298 0.4702508   0</span>
<span class="co">#&gt; 19: 0.7917348 0.7917348 0.7798731 0.7667273   0</span>
<span class="co">#&gt; 20: 0.8200804 0.8200804 0.8172346 0.8172346   0</span>
<span class="co">#&gt; 21: 0.8200804 0.8200804 0.8172346 0.8172346   0</span>
<span class="co">#&gt; 22: 0.5090525 0.5090525 0.3783095 0.2772669   0</span>
<span class="co">#&gt; 23: 0.5535508 0.5535508 0.4990962 0.4629840   0</span>
<span class="co">#&gt; 24: 0.5535508 0.5535508 0.4990962 0.4629840   0</span>
<span class="co">#&gt; 25: 0.7795001 0.7795001 0.7678217 0.7548791   0</span>
<span class="co">#&gt; 26: 0.8074078 0.8074078 0.8046059 0.8046059   0</span>
<span class="co">#&gt; 27: 0.8074078 0.8074078 0.8046059 0.8046059   0</span>
<span class="co">#&gt; 28: 0.5011862 0.5011862 0.3724635 0.2729823   0</span>
<span class="co">#&gt; 29: 0.5449968 0.5449968 0.4913837 0.4558296   0</span>
<span class="co">#&gt; 30: 0.5449968 0.5449968 0.4913837 0.4558296   0</span>
<span class="co">#&gt; 31: 0.7674546 0.7674546 0.7559566 0.7432140   0</span>
<span class="co">#&gt; 32: 0.7949309 0.7949309 0.7921724 0.7921724   0</span>
<span class="co">#&gt; 33: 0.7949309 0.7949309 0.7921724 0.7921724   0</span>
<span class="co">#&gt; 34: 0.4934414 0.4934414 0.3667079 0.2687639   0</span>
<span class="co">#&gt; 35: 0.5365750 0.5365750 0.4837904 0.4487857   0</span>
<span class="co">#&gt; 36: 0.5365750 0.5365750 0.4837904 0.4487857   0</span>
<span class="co">#&gt; 37: 0.7555951 0.7555951 0.7442749 0.7317292   0</span>
<span class="co">#&gt; 38: 0.7826469 0.7826469 0.7799310 0.7799310   0</span>
<span class="co">#&gt; 39: 0.7826469 0.7826469 0.7799310 0.7799310   0</span>
<span class="co">#&gt; 40: 0.4858163 0.4858163 0.3610412 0.2646107   0</span>
<span class="co">#&gt; 41: 0.5282833 0.5282833 0.4763144 0.4418506   0</span>
<span class="co">#&gt; 42: 0.5282833 0.5282833 0.4763144 0.4418506   0</span>
<span class="co">#&gt; 43: 0.7439190 0.7439190 0.7327737 0.7204218   0</span>
<span class="co">#&gt; 44: 0.7705527 0.7705527 0.7678788 0.7678788   0</span>
<span class="co">#&gt; 45: 0.7705527 0.7705527 0.7678788 0.7678788   0</span>
<span class="co">#&gt;           100       101       102       103 104</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-does-mcboost-do">What does mcboost do?<a class="anchor" aria-label="anchor" href="#what-does-mcboost-do"></a>
</h2>
<p>Internally mcboostsurv runs the following procedure <code>max_iter</code> times (similar ro <code>mcboost</code>, just for distributions over time):</p>
<ol style="list-style-type: decimal">
<li>Predict on X using the model from the previous iteration, <code>init_predictor</code> in the first iteration.</li>
<li>Compute the residuals <code>res = y - y_hat</code> for all time points</li>
<li>Split predictions into <code>num_buckets</code> according to <code>y_hat</code> and time.</li>
<li>Fit the auditor (<code>auditor_fitter</code>) (here called<code>c(x)</code>) on the data in each bucket with target variable <code>r</code>.</li>
<li>Compute <code>misscal = mean(c(x) * res(x))</code>
</li>
<li>if <code>misscal &gt; alpha</code>: For the bucket with highest <code>misscal</code>, update the model using the prediction <code>c(x)</code>. else: Stop the procedure</li>
</ol>
</div>
<div class="section level2">
<h2 id="multicalibrate-model-trained-on-pbc-data">Multicalibrate model trained on PBC data<a class="anchor" aria-label="anchor" href="#multicalibrate-model-trained-on-pbc-data"></a>
</h2>
<p>Based on this, we can now show multicalibration on a data set with two sensitive attributes (age and gender). Again, we load and pre-process the data.</p>
<div class="section level3">
<h3 id="load-dataset">Load Dataset<a class="anchor" aria-label="anchor" href="#load-dataset"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
<span class="va">data_pbc</span> <span class="op">=</span> <span class="va">pbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>status <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">task_pbc</span> <span class="op">=</span> <span class="va"><a href="https://mlr3proba.mlr-org.com/reference/TaskSurv.html" class="external-link">TaskSurv</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"pbc"</span>, backend <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_data_backend.html" class="external-link">as_data_backend</a></span><span class="op">(</span><span class="va">data_pbc</span><span class="op">)</span>, 
                        time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span><span class="op">)</span>


<span class="co">#Create data split</span>

<span class="va">train_test</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"holdout"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">$</span><span class="fu">instantiate</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">)</span>
<span class="va">train_g</span> <span class="op">=</span> <span class="va">train_test</span><span class="op">$</span><span class="fu">train_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">test_ids</span> <span class="op">=</span> <span class="va">train_test</span><span class="op">$</span><span class="fu">test_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">train_val</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"holdout"</span>, ratio <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">$</span><span class="fu">instantiate</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">train_g</span><span class="op">)</span><span class="op">)</span>
<span class="va">train_ids</span> <span class="op">=</span> <span class="va">train_val</span><span class="op">$</span><span class="fu">train_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">val_ids</span> <span class="op">=</span> <span class="va">train_val</span><span class="op">$</span><span class="fu">test_set</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Train distributional survival model </span>

<span class="va">xgb_distr</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="fu"><a href="https://mlr3pipelines.mlr-org.com//reference/ppl.html" class="external-link">ppl</a></span><span class="op">(</span><span class="st">"distrcompositor"</span>,
               learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"surv.xgboost"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">xgb_distr</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">train_ids</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mutlicalibrate-survival-model-with-validation-data">Mutlicalibrate survival model with validation data<a class="anchor" aria-label="anchor" href="#mutlicalibrate-survival-model-with-validation-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize mcboost</span>
 <span class="va">mcboost_learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span>
   <span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/ppl_mcboostsurv.html">ppl_mcboostsurv</a></span><span class="op">(</span>
     learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">prep_pipe</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com//reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span> <span class="va">xgb_distr</span><span class="op">)</span>, 
     param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
       alpha <span class="op">=</span> <span class="fl">1e-6</span>,
       eta <span class="op">=</span> <span class="fl">0.2</span>,
       time_buckets <span class="op">=</span> <span class="fl">2</span>,
       num_buckets <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="co"># multicalibrate model</span>
<span class="va">mcboost_learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">val_ids</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get new predictions</span>
<span class="va">test_task</span> <span class="op">=</span> <span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span>
<span class="va">pred_pbc_mc</span> <span class="op">=</span> <span class="va">mcboost_learner</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span><span class="op">)</span>

<span class="va">pred_pbc_xgb</span> <span class="op">=</span> <span class="va">xgb_distr</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task_pbc</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">test_ids</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development-of-ibs-in-the-defined-subgroups">Development of IBS in the defined subgroups<a class="anchor" aria-label="anchor" href="#development-of-ibs-in-the-defined-subgroups"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">pred_pbc_xgb</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"surv.graf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; surv.graf </span>
<span class="co">#&gt; 0.2714173</span>
<span class="va">pred_pbc_mc</span><span class="op">$</span><span class="fu">score</span><span class="op">(</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"surv.graf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; surv.graf </span>
<span class="co">#&gt; 0.2201664</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Florian Pfisterer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
